- name: setup rabbitmq server
  hosts: rabbitmq
  become: yes

  tasks:
  - name: install rabbitmq server
    ansible.builtin.package:
      name: rabbitmq-server
      state: present

  - name: start and enable rabbitmq server
    ansible.builtin.service:
      state: started
      enabled: yes

  - name: created and provide permisssions to add_user
    community.rabbitmq.rabbitmq_user:
      user: roboshop
      password: roboshop123
      permissions:
       - vhost: /
         configure_priv: .*
         read_priv: .*
         write_priv: .*
      state: present
    


